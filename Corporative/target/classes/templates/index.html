<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3">
<head>
</head>
<title>CHI Corporation project</title>
<body>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1 "/>
<link rel="stylesheet" href="w3/w3.css"/>
<link rel="stylesheet" href="w3/w3-theme-teal.css"/>
<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css"/>
<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css"/>
<link rel="stylesheet" href="w3/tableexport.css"/>

<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.3/angular.min.js"></script>
<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>


<nav class="navbar navbar-inverse">
    <div class="container-fluid">
        <div class="navbar-header">
            <a class="navbar-brand w3-theme" href="index"><span class="glyphicon glyphicon-home"></span>To main</a>
        </div>
        \
        <div class="navbar-header">
            <a class="navbar-brand" href="index2"><span class="glyphicon glyphicon-list-alt"></span>Transactions</a>
        </div>
        \
        <div class="navbar-header">
            <a class="navbar-brand" href="index4"><span class="glyphicon glyphicon-list-alt"></span>Debtors</a>
        </div>
        <ul class="nav navbar-nav">
            <!--<li><a href="index2.html" class="glyphicon glyphicon-list-alt">Transactions</a></li>-->

            <li><a href="#" onclick="document.getElementById('id01').style.display='block'">
                <span class="glyphicon glyphicon-plus"></span>Add Person</a></li>
            <li><a href="#" onclick="document.getElementById('id03').style.display='block'">
                <span class="glyphicon glyphicon-usd"></span>Cash out</a></li>

        </ul>
        <ul class="nav navbar-nav navbar-right">
            <li><a href="index3" class="glyphicon glyphicon-list-alt">Deleted</a></li>
            <li><a href="#" onclick="Refresh()"><span class="glyphicon glyphicon-refresh"></span> Refresh </a></li>
            <!--<li><a href="../../login"><span class="glyphicon glyphicon-log-in"></span> Log IN</a></li>-->

            <!--<li ><a href="/login" onclick="OutFunc()"><span class="glyphicon glyphicon-log-out"></span> Log OUT</a></li>-->

            <li>
                <form th:action="@{/logout}" method="post">
                    <button type="submit" class="btn btn-danger btn-block"><span
                            lass="glyphicon glyphicon-log-out"></span> Log out
                    </button>
                </form>
            </li>

        </ul>
    </div>
</nav>


<!--Create Modal -->
<div id="id01" class="w3-modal">
    <div class="w3-modal-content w3-card-8 w3-animate-top">

        <header class="w3-container w3-theme-l1">
            <span onclick="document.getElementById('id01').style.display='none'" class="w3-closebtn">×</span>
            <h4>Create new Person</h4>
        </header>

        <div class="w3-row-padding">

            <div class="w3-half">

                <form class="w3-container w3-card-4">
                    <div>
                        <div class="w3-half"><br/>
                            <input class="w3-input" type="text" id="2name"/>
                            <label class="w3-label">Second name</label>
                        </div>
                        <div class="w3-half"><br/>
                            <input class="w3-input" type="text" id="name"/>
                            <label class="w3-label">Name</label>
                        </div>
                    </div>
                    <div class="w3-group">
                        <input class="w3-input" type="text" id="3name"/>
                        <label class="w3-label">Third Name</label>
                    </div>
                    <div class="w3-half">
                        <!--<input class="w3-input" type="text" id="department" >-->
                        <select class="form-control" id="department">
                            <option></option>
                            <option>.NET</option>
                            <option>ACCOUNTANT</option>
                            <option>ANDROID</option>
                            <option>BUSINESS ANALYST</option>
                            <option>CTO</option>
                            <option>DB</option>
                            <option>DESIGNER</option>
                            <option>ENGLISH TEACHER</option>
                            <option>IOS</option>
                            <option>JAVA</option>
                            <option>JAVA SCRIPT</option>
                            <option>CONTENT WRITER/SMM MANAGER</option>
                            <option>NODE JS</option>
                            <option>OFFICE MANAGER</option>
                            <option>PHP</option>
                            <option>PM</option>
                            <option>PYTHON</option>
                            <option>QA</option>
                            <option>RECRUTER</option>
                            <option>RUBY</option>
                            <option>SALES</option>
                            <option>SYSTEM ADMINISTRATOR</option>
                            <option>DRIVER</option>
                            <option>SECURITY SERVICE</option>
                        </select>
                        <label class="w3-label">Department</label>
                    </div>
                    <div class="w3-half">
                        <select class="form-control" id="position">
                            <option></option>
                            <option>Intern</option>
                            <option>Junior</option>
                            <option>Middle</option>
                            <option>Senior</option>
                            <option>Team Lead</option>
                        </select>
                        <label class="w3-label">Position</label>
                    </div>
                    <div class="w3-half">
                        <input id="date_recruit" class="w3-input" type="date" placeholder="01.01.2016"/>
                        <label class="w3-label">Date Recruit</label>
                        <br/>
                    </div>
                    <div class="w3-half">
                        <!--<input class="w3-input" type="number" id="pweek" min="1" max="31" placeholder="1-31" >-->
                        <select class="form-control" id="pweek">
                            <option>I</option>
                            <option>10</option>
                            <option>15</option>
                            <option>25</option>
                        </select>
                        <label class="w3-label">Payment day</label>
                    </div>
                    <div class="w3-group">
                        <h2>Comments</h2>
                        <textarea class="form-control" rows="5" id="comment"></textarea>
                    </div>
                </form>
            </div>
            <div class="w3-half">
                <form class="w3-container w3-card-4">
                    <div class="w3-group ">
                        <div class="w3-half">
                            <label class="w3-label">CASH BACK </label>
                        </div>
                        <div class="w3-half">
                            Dinners UAH<input class="w3-input w3-border" type="number" id="dinners" value="0"/>
                            .
                        </div>
                        <div class="w3-half">
                            Taxes UAH<input class="w3-input w3-border" type="number" id="taxes" value="0"/>
                        </div>
                        <div class="w3-half">
                            Overtimes USD<input class="w3-input w3-border" type="number" id="overtimes" value="0"/>
                        </div>
                        <div class="w3-half">
                            Bonus USD<input class="w3-input w3-border" type="number" id="bonus" value="0"/>
                        </div>
                        <div class="w3-half">
                            Another UAH<input class="w3-input w3-border" type="number" id="another" value="0"/>
                        </div>
                        <!--<label class="w3-label">Cash back $</label>-->
                        <!--<input class="form-control" id="cashback" type="number" value="0">-->
                    </div>

                    <div class="w3-group w3-half">
                        <label class="w3-label">SALARY USD</label>
                        <input class="form-control" id="rate" type="number" value="0"/>
                    </div>
                    <div class="w3-section" style="width:50%">
                        <button type="reset" class="w3-btn-block w3-blue-grey" onclick="RestPut()">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!--Update Modal -->
<div id="id02" class="w3-modal">
    <div class="w3-modal-content w3-card-8 w3-animate-top">

        <header class="w3-container w3-theme-l1">
            <span onclick="document.getElementById('id02').style.display='none'" class="w3-closebtn">×</span>
            <h4>Updated Person</h4>
        </header>

        <div class="w3-row-padding">

            <div class="w3-half">

                <form class="w3-container w3-card-4">
                    <div class="w3-half"><br/>
                        <label class="w3-label">Person id:</label>
                        <input class="form-control" id="upId" type="number" disabled="disabled"/>
                    </div>
                    <div class="w3-group w3-half">
                        <label class="w3-label">Count</label>
                        <input class="form-control" id="upCount" type="number"/>
                    </div>
                    <div>
                        <div class="w3-half"><br/>
                            <input class="w3-input" type="text" id="upName"/>
                            <label class="w3-label">Name</label>
                        </div>
                        <div class="w3-half"><br/>
                            <input class="w3-input" type="text" id="upName2"/>
                            <label class="w3-label">Second name</label>
                        </div>
                    </div>
                    <div class="w3-group">
                        <input class="w3-input" type="text" id="upName3"/>
                        <label class="w3-label">Third Name</label><br/>
                    </div>
                    <div class="w3-half">
                        <select class="form-control" id="upDepartment">
                            <option></option>
                            <option>.NET</option>
                            <option>ACCOUNTANT</option>
                            <option>ANDROID</option>
                            <option>BUSINESS ANALYST</option>
                            <option>CTO</option>
                            <option>DB</option>
                            <option>DESIGNER</option>
                            <option>ENGLISH TEACHER</option>
                            <option>IOS</option>
                            <option>JAVA</option>
                            <option>JAVA SCRIPT</option>
                            <option>CONTENT WRITER/SMM MANAGER</option>
                            <option>NODE JS</option>
                            <option>OFFICE MANAGER</option>
                            <option>PHP</option>
                            <option>PM</option>
                            <option>PYTHON</option>
                            <option>QA</option>
                            <option>RECRUTER</option>
                            <option>RUBY</option>
                            <option>SALES</option>
                            <option>SYSTEM ADMINISTRATOR</option>
                            <option>DRIVER</option>
                            <option>SECURITY SERVICE</option>
                        </select>
                        <label class="w3-label">Department</label>
                        <br/>
                    </div>
                    <div class="w3-half">
                        <select class="form-control" id="upPosition">
                            <option></option>
                            <option>Intern</option>
                            <option>Junior</option>
                            <option>Middle</option>
                            <option>Senior</option>
                            <option>Team Lead</option>
                        </select>
                        <label class="w3-label">Position</label>
                    </div>
                    <div class="w3-half">
                        <input class="w3-input" type="text" id="upDate_recruit"/>
                        <label class="w3-label">Date Recruit</label>
                    </div>
                    <div class="w3-half">
                        <!--<input class="w3-input" type="number" id="upCash_date" min="1" max="31" >-->
                        <select class="form-control" id="upCash_date">
                            <option>I</option>
                            <option>10</option>
                            <option>15</option>
                            <option>25</option>
                        </select>
                        <label class="w3-label">Payment day</label><br/>
                    </div>
                </form>
            </div>
            <div class="w3-half">
                <form class="w3-container w3-card-4">
                    <div class="w3-group">
                        <h2>Comments</h2>
                        <textarea class="form-control" rows="5" id="upComments"></textarea>
                    </div>
                    <div class="w3-group ">
                        <div class="w3-half">
                            <label class="w3-label">CASH BACK </label>
                        </div>
                        <div class="w3-half">
                            Dinners UAH<input class="w3-input w3-border" type="number" id="upDinners"
                                              placeholder="Dinners"/>
                        </div>
                        <div class="w3-half">
                            Taxes UAH<input class="w3-input w3-border" type="number" id="upTaxes" placeholder="Taxes"/>
                        </div>
                        <div class="w3-half">
                            Overtimes USD<input class="w3-input w3-border" type="number" id="upOvertimes"
                                                placeholder="Overtimes"/>
                        </div>
                        <div class="w3-half">
                            Bonus USD<input class="w3-input w3-border" type="number" id="upBonus" placeholder="Bonus"/>
                        </div>
                        <div class="w3-half">
                            Another UAH<input class="w3-input w3-border" type="number" id="upAnother"
                                              placeholder="Another"/>
                        </div>
                        <!--<label class="w3-label">Cash back $</label>-->
                        <!--<input class="form-control" id="cashback" type="number" value="0">-->
                    </div>

                    <div class="w3-group w3-half">
                        <label class="w3-label">SALARY USD</label>
                        <input class="form-control" id="upRate" type="number" value="0"/>

                    </div>

                    <div class="w3-group w3-half">
                        <!--<div class="w3-section" style="width:50%">-->
                        <br/>
                        <button type="reset" class="w3-btn-block w3-blue-grey" onclick="RestUpdate()">Update Person
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>


<!--Cash Modal -->
<div id="id03" class="w3-modal2">
    <div class="w3-modal2-content w3-card-8 w3-animate-top">

        <header class="w3-container w3-theme-l1">
            <span onclick="document.getElementById('id03').style.display='none'" class="w3-closebtn">×</span>
            <h4>Cash out $$</h4>
        </header>
        <div>
            <div class="w3-row-padding">
                <form class="w3-container w3-card-4">
                    <div>
                        <div class="w3-half"><br/>
                            <input class="w3-input w3-border w3-round" type="number" id="cash_id" min="1"/>
                            <label class="w3-label">id</label>
                        </div>
                        <div class="w3-half"><br/>
                            <input id="pay_date" class="w3-input" type="date" placeholder="01.01.2016"/>
                            <label class="w3-label">Date</label>
                        </div>
                    </div>
                    <div>
                        <div class="w3-half"><br/>
                            <input class="w3-input w3-border w3-round" type="number" id="cash_pay" min="1"/>
                            <label class="w3-label">Pay</label>
                        </div>
                        <div class="w3-half"><br/>
                            <input class="w3-input w3-border w3-round" type="number" id="cash_count" value="0"/>
                            <label class="w3-label">Balance</label>
                        </div>
                    </div>
                    <div>
                        <div class="w3-half"><br/>
                            <input class="w3-input w3-border w3-round" type="number" id="cash_course" min="1"/>
                            <label class="w3-label">Course $</label>
                        </div>
                    </div>
                    <div class="w3-group w3-half">
                        <!--<div class="w3-section" style="width:50%">-->
                        <br/>
                        <button type="reset" class="w3-btn-block w3-blue-grey" onclick="RestCash()">Give Cash</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!--Input Modal -->
<div ng-controller="customersCtrl" id="id04" class="w3-modal2">
    <div class="w3-modal2-content w3-card-8 w3-animate-top">

        <header class="w3-container w3-theme-l1">
            <span onclick="document.getElementById('id04').style.display='none'" class="w3-closebtn">×</span>
            <h4>Input File .xls</h4>
        </header>
        <div ng-controller="customersCtrl">
            <div class="w3-row-padding">
                <form class="w3-container w3-card-4">
                    <div class="w3-group w3-half">
                        <br/>
                        <input type="file" name="file" accept="xlsx" id="idfile" value="Обзор"/>
                        <br/>
                        <button type="submit" onclick="InputFile()" th:href="index2">Input Excel File</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script src="w3/xlsx.core.js"></script>
<script src="w3/Blob.js"></script>
<script src="w3/jquery-3.1.1.js"></script>
<script src="w3/FileSaver.js"></script>
<script src="w3/tableexport.js"></script>
<script src="w3/script1.js"></script>
<script>
    var RestExport = function () {

    $("table").tableExport({fileName:"Salary Person Information"});
    $(".xlsx").click();
    $(".xlsx").remove();

    //tableExport();

}</script>
<!-- Content -->
<div ng-app="myApp">
    <div class="w3-container">

        <button type="reset" onclick="ChangeCourse()">$</button>

        <input type="number" ng-model="ua" id="exchange_course" width="10px" value=""/>

        <button type="reset" onclick="RestExport()" class="btn btn-default xls">Export Salary List to xlsx</button>

        <button type="reset" onclick="document.getElementById('id04').style.display='block'"
                class="btn btn-default xls">Input Salary List from xlsx
        </button>


        <div class="w3-center">
            <label>CHI Software personal</label>
        </div>

        <div ng-controller="customersCtrl">
            <div class="w3-responsive w3-card-4">
                <table class="w3-table \-6u(wide) w3-striped w3-bordered w3-display-right" id="table">
                    <thead>
                    <tr>
                        <td width="75"><input class="w3-input w3-border w3-round" size="4" ng-model="f.id"/></td>
                        <td width="10%"><input class="w3-input w3-border w3-round" ng-model="f.name"/></td>
                        <td width="75"><select class="form-control" ng-model="f.department">
                            <option></option>
                            <option>.NET</option>
                            <option>ACCOUNTANT</option>
                            <option>ANDROID</option>
                            <option>BUSINESS ANALYST</option>
                            <option>CTO</option>
                            <option>DB</option>
                            <option>DESIGNER</option>
                            <option>ENGLISH TEACHER</option>
                            <option>IOS</option>
                            <option>JAVA</option>
                            <option>JAVA SCRIPT</option>
                            <option>CONTENT WRITER</option>
                            <option>NODE JS</option>
                            <option>OFFICE MANAGER</option>
                            <option>PHP</option>
                            <option>PM</option>
                            <option>PYTHON</option>
                            <option>QA</option>
                            <option>RECRUTER</option>
                            <option>RUBY</option>
                            <option>SALES</option>
                            <option>SYSTEM ADMIN</option>
                            <option>DRIVER</option>
                            <option>SECURITY</option>
                        </select></td>
                        <td width="75"><select class="form-control" ng-model="f.position">
                            <option></option>
                            <option>Intern</option>
                            <option>Junior</option>
                            <option>Middle</option>
                            <option>Senior</option>
                            <option>Team Lead</option>
                        </select></td>
                        <td></td>
                        <td width="85"><select class="form-control" ng-model="f.cash_date">
                            <option></option>
                            <option>I</option>
                            <option>10</option>
                            <option>15</option>
                            <option>25</option>
                        </select></td>
                        <td width="75"></td>
                        <td><input class="w3-input w3-border w3-round" size="6" ng-model="f.cash_back"/></td>
                        <td><input class="w3-input w3-border w3-round" size="5" ng-model="f.rate"/></td>
                        <td><input class="w3-input w3-border w3-round" size="4" ng-model="f.count"/></td>
                        <td></td>
                        <td></td>
                    </tr>
                    </thead>
                    <tbody id="mainTable">
                    <tr class="w3-theme">
                        <th>id</th>
                        <th>Full Name</th>
                        <th>Department</th>
                        <th>Position</th>
                        <th>Date Recruit</th>
                        <th>Cash Date</th>
                        <th>Comments</th>
                        <th>Cash Back USD</th>
                        <th>Cash Back UAH</th>
                        <th>Rate USD</th>
                        <th>Balance USD</th>
                        <th>Rate UAH</th>
                        <th>Balance UAH</th>

                        <th>Edit</th>
                        <th>Delete</th>
                    </tr>
                    <tr ng-repeat="x in names | orderBy :'id' |  filter:f">
                        <td>{{ x.id }}</td>
                        <td>{{ x.name2}} {{ x.name}} {{ x.name3}}</td>
                        <td>{{ x.department}}</td>
                        <td>{{ x.position}}</td>
                        <td>{{ x.date_recruit}}</td>
                        <td>{{x.cash_date}}</td>
                        <td>
                            <a href="#" ng-show="showMe(x.comments)" data-toggle="tooltip" title="{{x.comments}}">
                                <span class="glyphicon glyphicon-comment" ng-click="comFunction(x.comments)"></span>
                            </a>
                        </td>
                        <td>{{ x.cash_back_usd|number:2}} USD</td>
                        <td>{{ x.cash_back_uah|number:2}} UAH</td>
                        <td>{{ x.rate|number:2}} USD</td>
                        <td class="w3-sand">{{ x.cash_back_usd+x.cash_back_uah/ua+x.rate|number:2}} USD</td>
                        <td>{{ x.rate*ua|number:2}} UAH</td>
                        <td class="w3-pale-red">{{ (x.cash_back_usd+x.rate)*ua+x.cash_back_uah|number:2}} UAH</td>
                        <td><a href="#" ng-click="updateFunction(x)">
                            <span class="glyphicon glyphicon-pencil"></span>
                        </a></td>
                        <td><a href="#" ng-click="DeleteFunction(x.id)">
                            <span class="glyphicon glyphicon-trash"></span>
                        </a></td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <script>

            $(document).ready(function () {
                $('[data-toggle="tooltip"]');
            });

            var app = angular.module('myApp', []);
            app.factory('Excel',function($window){
                        var uri='data:application/vnd.ms-excel;base64,',
                                template='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>',
                                base64=function(s){return $window.btoa(unescape(encodeURIComponent(s)));},
                                format=function(s,c){return s.replace(/{(\w+)}/g,function(m,p){return c[p];})};
                        return {
                            tableToExcel:function(tableId,worksheetName){
                                var table=$(tableId),
                                        ctx={worksheet:worksheetName,table:table.html()},
                                        href=uri+base64(format(template,ctx));
                                return href;
                            }
                        };
                    })
                    .controller('MyCtrl',function(Excel,$timeout){
                        $scope.exportToExcel=function(tableId){ // ex: '#my-table'
                            var exportHref=Excel.tableToExcel(tableId,'sheet name');
                            $timeout(function(){location.href=$scope.fileData.exportHref;},100); // trigger download
                        }
                    });


            app.controller('customersCtrl', function ($scope, $http) {

                $http.get("/person/")
                        .then(function (response) {
                            $scope.names = response.data;
                            $scope.ua = xhr.responseText;
                        });


                $scope.DeleteFunction = function (id) {
                    $http.get("/person/delete/" + id);
                    location.reload();
                }

                $scope.UpdateFunction = function () {

                }

                $scope.comFunction = function (comments) {
                    alert(comments);
                }
                $scope.showMe = function (comments) {
                    if (comments != "" ) {
                        return true;
                    }
                    else {
                        return false;
                    }
                }
                $scope.updateFunction = function (x) {

                    //$http.get("/person/update" + JSON.parse(x));

                    document.getElementById("upId").value = x.id;
                    document.getElementById("upName").value = x.name;
                    document.getElementById("upName2").value = x.name2;
                    document.getElementById("upName3").value = x.name3;
                    document.getElementById("upDepartment").value = x.department;
                    document.getElementById("upPosition").value = x.position;
                    document.getElementById("upDate_recruit").value = x.date_recruit;
                    document.getElementById("upCash_date").value = x.cash_date;
                    document.getElementById("upComments").value = x.comments;
                    document.getElementById("upRate").value = x.rate;
                    document.getElementById("upCount").value = x.count;
                    document.getElementById("upDinners").value = x.dinners;
                    document.getElementById("upTaxes").value = x.taxes;
                    document.getElementById("upOvertimes").value = x.overtimes;
                    document.getElementById("upBonus").value = x.bonus;
                    document.getElementById("upAnother").value = x.another;

                    document.getElementById('id02').style.display = 'block';
                }

            });

        </script>


        <hr/>
    </div>
</div>


<footer class="w3-container w3-theme-dark">
    <h3></h3>
    <p>© All rights reserved by CHI Software.
    <div style="position:relative;bottom:25px;" class="w3-tooltip w3-right">
        <span class="w3-text w3-theme-light w3-padding">Go To Top</span> 
        <a class="w3-text-white" href="#myHeader"><span class="w3-xlarge">
    <i class="fa fa-chevron-circle-up"></i></span></a>
    </div>
    </p>
</footer>
</body>
</html>
